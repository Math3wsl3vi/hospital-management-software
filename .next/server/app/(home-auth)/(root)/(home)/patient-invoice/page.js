(()=>{var e={};e.id=684,e.ids=[684],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},6113:e=>{"use strict";e.exports=require("crypto")},9523:e=>{"use strict";e.exports=require("dns")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},85158:e=>{"use strict";e.exports=require("http2")},41808:e=>{"use strict";e.exports=require("net")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},77282:e=>{"use strict";e.exports=require("process")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},64331:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>a.a,__next_app__:()=>m,originalPathname:()=>p,pages:()=>d,routeModule:()=>h,tree:()=>c});var i=t(67096),n=t(16132),r=t(37284),a=t.n(r),l=t(32564),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);t.d(s,o);let c=["",{children:["(home-auth)",{children:["(root)",{children:["(home)",{children:["patient-invoice",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,63488)),"/home/levi/Desktop/codingStuff/nextProjects/hospital-management-system/hms/app/(home-auth)/(root)/(home)/patient-invoice/page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,89846)),"/home/levi/Desktop/codingStuff/nextProjects/hospital-management-system/hms/app/(home-auth)/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,9291,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,57481))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(t.bind(t,8939)),"/home/levi/Desktop/codingStuff/nextProjects/hospital-management-system/hms/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,9291,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,57481))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],d=["/home/levi/Desktop/codingStuff/nextProjects/hospital-management-system/hms/app/(home-auth)/(root)/(home)/patient-invoice/page.tsx"],p="/(home-auth)/(root)/(home)/patient-invoice/page",m={require:t,loadChunk:()=>Promise.resolve()},h=new i.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/(home-auth)/(root)/(home)/patient-invoice/page",pathname:"/patient-invoice",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},59574:(e,s,t)=>{Promise.resolve().then(t.bind(t,75672))},75672:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var i=t(30784),n=t(71462),r=t(9885),a=t(13422),l=t(47805),o=t(33770),c=t(95555),d=t(29904),p=t(92),m=t(465),h=t(40516),x=t(52451),u=t.n(x);let __WEBPACK_DEFAULT_EXPORT__=()=>{let e=(0,n.L)(e=>e.selectedUser),{docNotes:s}=(0,l.g)(),{toast:t}=(0,m.pm)(),x=(0,r.useRef)(null),j=s.medication?.split(",").map(e=>{let[s,t,i,n]=e.split("-");return{name:s,dosage:t,frequency:i,duration:n}}),[v,f]=(0,r.useState)(j?.map(()=>({amount:0}))||[]),[g,N]=(0,r.useState)(j?.map(()=>({quantity:""}))||[]),y=v.reduce((e,s)=>e+(s.amount||0),0)+250,handleAmountChange=(e,s)=>{let t=[...v];t[e].amount=parseFloat(s)||0,f(t)},handleQuantityChange=(e,s)=>{let t=[...g];t[e].quantity=s,N(t)},saveInvoice=async()=>{try{if(!e?.email){alert("No patient email found!"),console.log("Selected User:",e);return}let s=`visit_${Date.now()}`,i=(0,d.JU)(p.db,"patient-medication",e.email.replace(/[@.]/g,"_")),n=(0,d.JU)((0,d.hJ)(i,"visits"),s);await (0,d.pl)(n,{patientId:e?.id,patientName:e?.name,patientEmail:e?.email,consultationFee:250,totalAmount:y,visitId:s,visitDate:new Date().toISOString()});let r=(0,d.hJ)(n,"medications");await Promise.all(j.map(async(e,t)=>{await (0,d.ET)(r,{visitId:s,name:e.name,dosage:e.dosage,frequency:e.frequency,duration:e.duration,amount:v[t]?.amount||0,quantity:g[t]?.quantity||"0"})})),t({description:"Medication sent to the app. Login to view!"})}catch(e){console.error("Error saving invoice: ",e),alert("Failed to save invoice.")}};return(0,i.jsxs)("div",{ref:x,className:"flex flex-col gap-10 invoice-container print:block",children:[(0,i.jsxs)("div",{className:"flex flex-row justify-between items-center",children:[i.jsx("div",{children:i.jsx("h1",{className:"text-3xl",children:"HMS"})}),i.jsx("div",{children:i.jsx("h1",{className:"text-4xl font-semibold",children:"INVOICE"})})]}),(0,i.jsxs)("div",{className:"flex flex-row justify-between items-center",children:[(0,i.jsxs)("div",{children:[i.jsx("p",{children:"P.O BOX 550 Lanet"}),i.jsx("p",{children:"Nakuru, kenya"}),(0,i.jsxs)("p",{children:[" ",i.jsx("span",{className:"font-semibold",children:"Phone:"})," 0722 123 555"]}),(0,i.jsxs)("p",{children:[" ",i.jsx("span",{className:"font-semibold",children:"Fax:"})," 432 5563 4902"]})]}),(0,i.jsxs)("div",{children:[i.jsx("p",{children:"Invoice No: 001"}),(0,i.jsxs)("p",{children:[i.jsx("span",{className:"font-semibold",children:"Date:"})," Feb, 1 2025"]})]})]}),(0,i.jsxs)("div",{children:[i.jsx("h1",{className:"text-green-1 text-lg mb-4",children:"PATIENT DETAILS"}),(0,i.jsxs)("div",{className:"flex flex-row justify-between items-center",children:[(0,i.jsxs)("div",{className:"text-xl",children:[(0,i.jsxs)("p",{className:"capitalize",children:[i.jsx("span",{className:"font-semibold uppercase ",children:"Name:"})," ",e?.name," "]}),(0,i.jsxs)("p",{className:"capitalize",children:[i.jsx("span",{className:"font-semibold uppercase",children:"Age:"})," 23"]}),(0,i.jsxs)("p",{className:"capitalize",children:[i.jsx("span",{className:"font-semibold uppercase ",children:"Email:"})," ",e?.email," "]})]}),(0,i.jsxs)("div",{className:"text-lg",children:[(0,i.jsxs)("p",{className:"capitalize",children:[i.jsx("span",{className:"font-semibold uppercase",children:"National Id:"})," ",e?.id]}),(0,i.jsxs)("p",{className:"capitalize",children:[i.jsx("span",{className:"font-semibold uppercase",children:"Insurance Provider:"})," ",e?.insuranceProvider]}),(0,i.jsxs)("p",{className:"capitalize",children:[i.jsx("span",{className:"font-semibold uppercase",children:"insurance Number:"})," ",e?.insurancePolicyNumber]})]})]})]}),(0,i.jsxs)(a.iA,{children:[i.jsx(a.Rn,{children:"A list of your recent invoices."}),i.jsx(a.xD,{children:(0,i.jsxs)(a.SC,{children:[i.jsx(a.ss,{className:"w-[100px]",children:"#"}),i.jsx(a.ss,{children:"Service"}),i.jsx(a.ss,{className:"text-right",children:"Amount (Ksh)"})]})}),i.jsx(a.RM,{children:(0,i.jsxs)(a.SC,{children:[i.jsx(a.pj,{className:"font-medium",children:"INV001"}),i.jsx(a.pj,{children:"Consultation Fee"}),i.jsx(a.pj,{className:"text-right",children:"250.00"})]})})]}),i.jsx("div",{children:(0,i.jsxs)(a.iA,{children:[i.jsx(a.xD,{children:(0,i.jsxs)(a.SC,{children:[i.jsx(a.ss,{children:"#"}),i.jsx(a.ss,{children:"Medication"}),i.jsx(a.ss,{children:"Dosage"}),i.jsx(a.ss,{children:"Quantity"}),i.jsx(a.ss,{children:"Subtotal"}),i.jsx(a.ss,{children:"Amount"})]})}),i.jsx(a.RM,{children:j?.map((e,s)=>i.jsxs(a.SC,{children:[i.jsx(a.pj,{children:s+1}),i.jsx(a.pj,{children:e.name}),i.jsx(a.pj,{children:e.dosage}),i.jsx(a.pj,{className:"w-[200px]",children:i.jsx(o.I,{placeholder:"Quantity",value:g[s]?.quantity||"",onChange:e=>handleQuantityChange(s,e.target.value)})}),i.jsx(a.pj,{className:"w-[200px]",children:i.jsx(o.I,{placeholder:"Subtotal",type:"number",value:v[s]?.amount||"",onChange:e=>handleAmountChange(s,e.target.value)})}),i.jsx(a.pj,{className:"w-[200px]",children:v[s]?.amount.toFixed(2)})]},s))})]})}),i.jsx("div",{className:"flex items-end justify-end",children:(0,i.jsxs)("div",{className:"w-1/2 flex flex-col gap-2",children:[i.jsx(a.iA,{children:(0,i.jsxs)(a.SC,{children:[i.jsx(a.pj,{children:"Total (Ksh)"}),i.jsx(a.pj,{children:y.toFixed(2)})]})}),(0,i.jsxs)("div",{className:"flex justify-between items-center w-full gap-5 mt-10 print:hidden",children:[i.jsx(c.z,{className:"bg-green-1 w-1/3",onClick:saveInvoice,children:"Add medication to our App"}),i.jsx(c.z,{onClick:()=>window.print(),className:"bg-green-1 text-white w-1/3",children:"Print Invoice"}),i.jsx("div",{className:"w-full border bg-green-1 rounded-md",children:(0,i.jsxs)(h.Vq,{children:[i.jsx(h.hg,{className:"w-full h-9 px-4 py-2 text-white text-sm hover:bg-primary/90 hover:rounded-md",children:"Proceed to Payment"}),i.jsx(h.cZ,{children:(0,i.jsxs)(h.fK,{children:[i.jsx(h.$N,{children:"Payment Confirmation"}),(0,i.jsxs)(h.Be,{children:[i.jsx("div",{className:"flex justify-center items-center",children:i.jsx(u(),{src:"/images/success.gif",alt:"success",width:200,height:200})}),"Your payment has been successfully sent to your insurance provider for approval."]}),i.jsx(h.GG,{children:i.jsx("div",{className:"flex justify-end",children:i.jsx("h1",{className:"py-2 px-4 h-9 bg-red-500 rounded-md text-sm text-white",children:"Close"})})})]})})]})})]})]})})]})}},47805:(e,s,t)=>{"use strict";t.d(s,{g:()=>r});var i=t(88944),n=t(48228);let r=(0,i.U)()((0,n.tJ)(e=>({docNotes:{symptoms:"",medication:"",diagnosis:""},setDocNotes:s=>e({docNotes:s})}),{name:"docNotes-storage"}))},71462:(e,s,t)=>{"use strict";t.d(s,{L:()=>r});var i=t(88944),n=t(48228);let r=(0,i.U)()((0,n.tJ)(e=>({selectedUser:null,setSelectedUser:s=>e({selectedUser:s})}),{name:"user-storage"}))},63488:(e,s,t)=>{"use strict";t.r(s),t.d(s,{$$typeof:()=>a,__esModule:()=>r,default:()=>o});var i=t(95153);let n=(0,i.createProxy)(String.raw`/home/levi/Desktop/codingStuff/nextProjects/hospital-management-system/hms/app/(home-auth)/(root)/(home)/patient-invoice/page.tsx`),{__esModule:r,$$typeof:a}=n,l=n.default,o=l}};var s=require("../../../../../webpack-runtime.js");s.C(e);var __webpack_exec__=e=>s(s.s=e),t=s.X(0,[1955,225,488,430,1094,7589,3137,7246,7945,92,516,3422],()=>__webpack_exec__(64331));module.exports=t})();