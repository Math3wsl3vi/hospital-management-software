"use strict";exports.id=7473,exports.ids=[7473],exports.modules={6477:(e,r,s)=>{s.d(r,{Z:()=>components_History});var t=s(30784),i=s(9885),n=s(40516),d=s(71462),o=s(91706),c=s(92),a=s(29904);let fetchMedicationsGroupedByVisitId=async e=>{try{console.log(`Fetching medications for email: ${e}`);let r=e.replace(/[@.]/g,"_"),s=(0,a.hJ)(c.db,"patient-medication",r,"visits"),t=await (0,a.PL)(s);if(console.log(`Found ${t.docs.length} visits`),t.empty)return console.warn("No visits found."),{};let i={};for(let e of t.docs){let r=e.id;console.log(`Processing visit ID: ${r}`);let s=(0,a.hJ)(e.ref,"medications"),t=await (0,a.PL)(s);console.log(`Found ${t.docs.length} items for visit ${r}`),t.empty?console.warn(`No medications found for visit ID ${r}`):i[r]=t.docs.map(e=>{let r=e.data();console.log("Fetched item data:",r);let s=r.date?.toDate?r.date.toDate().toLocaleDateString("en-GB"):"Unknown";return{id:e.id,name:r.name||"Unknown",dosage:r.dosage||"N/A",amount:r.amount||0,frequency:r.frequency||"N/A",duration:r.duration||"N/A",quantity:r.quantity||"N/A",date:s}})}return console.log("Final grouped medications:",i),i}catch(e){return console.error("Error fetching medications:",e),{}}},components_History=()=>{let e=(0,d.L)(e=>e.selectedUser),[r,s]=(0,i.useState)({}),[c,a]=(0,i.useState)(!1),fetchMedications=async()=>{if(e?.email){a(!0);try{let r=await fetchMedicationsGroupedByVisitId(e.email);s(r)}catch(e){console.error("Error fetching medications:",e)}a(!1)}};return t.jsx(t.Fragment,{children:(0,t.jsxs)("div",{className:"grid grid-cols-3 mb-5",children:[(0,t.jsxs)(n.Vq,{children:[(0,t.jsxs)(n.hg,{className:"border p-2 text-center active:bg-green-1 active:text-white cursor-pointer hover:text-white hover:bg-green-1",children:["Patient's"," Records"]}),t.jsx(n.cZ,{children:(0,t.jsxs)(n.fK,{children:[t.jsx(n.$N,{className:"capitalize",children:"Medical Records"}),(0,t.jsxs)("div",{className:"flex flex-col gap-4 mt-10",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)(o._,{children:["Patient's"," Name"]}),t.jsx("h1",{className:"p-1 border border-gray-300 rounded-md",children:e?.name})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)(o._,{children:["Patient's"," National Id"]}),t.jsx("h1",{className:"p-1 border border-gray-300 rounded-md",children:e?.id})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)(o._,{children:["Patient's"," Date Of Birth"]}),t.jsx("h1",{className:"p-1 border border-gray-300 rounded-md",children:e?.dob})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)(o._,{children:["Patient's"," Gender"]}),t.jsx("h1",{className:"p-1 border border-gray-300 rounded-md",children:e?.sex})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)(o._,{children:["Patient's"," Insurance Provider"]}),t.jsx("h1",{className:"p-1 border border-gray-300 rounded-md",children:e?.insuranceProvider||"N/A"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)(o._,{children:["Patient's"," Insurance Policy Number"]}),t.jsx("h1",{className:"p-1 border border-gray-300 rounded-md",children:e?.insurancePolicyNumber||"N/A"})]})]})]})})]}),(0,t.jsxs)(n.Vq,{children:[t.jsx(n.hg,{className:"border p-2 text-center active:bg-green-1 active:text-white cursor-pointer hover:text-white hover:bg-green-1",children:"Appointments"}),t.jsx(n.cZ,{children:(0,t.jsxs)(n.fK,{children:[t.jsx(n.$N,{children:"NOTICE!"}),t.jsx(n.Be,{children:"Appointments not available at the moment."})]})})]}),(0,t.jsxs)(n.Vq,{children:[t.jsx(n.hg,{className:"border p-2 text-center active:bg-green-1 active:text-white cursor-pointer hover:text-white hover:bg-green-1",onClick:fetchMedications,children:"Medication History"}),t.jsx(n.cZ,{children:(0,t.jsxs)(n.fK,{children:[t.jsx(n.$N,{children:"Medication History"}),c?t.jsx("p",{children:"Loading medications..."}):Object.keys(r).length>0?Object.entries(r).map(([e,r])=>t.jsx("div",{className:"mt-4 border p-3 rounded-lg shadow-sm",children:t.jsx("ul",{className:"mt-2",children:r.map(e=>(0,t.jsxs)("li",{className:"p-2 border-b",children:[t.jsx("strong",{children:e.name})," - ",e.dosage,", ",e.frequency,", ",e.duration]},e.id))})},e)):t.jsx("p",{children:"No medication history found."})]})})]})]})})}},83143:(e,r,s)=>{s.d(r,{B:()=>n});var t=s(88944),i=s(48228);let n=(0,t.U)()((0,i.tJ)(e=>({vitals:{weight:"",temp:"",bpm:"",heart:"",rate:"",height:""},setVitals:r=>e({vitals:r})}),{name:"vitals-storage"}))}};